<html lang="pt-br">
<head>
    <%- include('partials/head') %>
</head>
<body>
    <%- include('partials/header') %>
    <main class="ferreiro container mt-4">
        <div class="row">
         <div class="col-4 col-s-2"></div> 

         <div class="col-4 col-s-8">
            <h1> Bem-vindo mochileiro</h1>
            <h3> Save atual: <%= save.nome_save %> ID:<%= save.id %></h3>
        </div>

        <div class="row mt-4">
            <div id="atrbt" class="menus save-display-menu col-md-4" >
                <p class="nome_reno"> Nome: <%= save.atributos.nome %></p>
                <input class="input_reno opcoes-save" type="text" name="novo_nome" placeholder="Novo Nome" value="<%= save.atributos.nome %>" required form="renomearForm"></input>
                <p> Nivel: <%= save.atributos.nivel %></p>
                <p> Vida: <%= save.atributos.vida_atual %> / <%= save.atributos.vida_maxima %></p>
                <p> Ataque: <%= save.atributos.ataque %></p>
                <p> Defesa: <%= save.atributos.defesa %></p>
                <p> Dinheiro: <%= save.dinheiro %></p>
                <%- include('partials/adotarPetForm', { saveId: save.id }) %>
            </div>
            <div id="menu" class="menus ferreiro opcoes-menu col-md-8">
                <button onclick="location.href='/menu'" type="button"> Voltar </button>
                <h2> Ferreiro </h2>
                <p> Aqui você pode melhorar seus equipamentos! </p>
                <p class="bold"> Custo por melhoria: 10 de dinheiro </p>
                <% if (save.dinheiro < 10) { %> <p class="red">  -- Você precisa de pelo menos 10 de dinheiro pa melhorar um item</p> <% } %>                 

                <div class="disponiveis">
                    <h3> Itens Disponíveis para Melhoria: </h3>
                    <% inventario = inventario || []; %>
                    <div class="inventario-container">
                        <ul class="inventario-lista">
                            <% if (inventario.length === 0) { %>
                                <li>O inventário não tem itens disponiveis para melhora.</li>
                            <% } else { %>
                                <% inventario.forEach(item => { %>
                                    <% if (item.atributo_chave !== 'nenhum') { %>
                                    <li class="inventario-item"> <!-- arrumem dps do jeito q vc querem pq eu n sou bom em design-->
                                        <span class="item-nome"><%= item.nome %></span>
                                        <span class="item-tipo">Tipo: <%= item.tipo %></span>
                                        <span class="item-atributo"> <%= item.atributo_chave %>: <%= item.atributo_chave === 'Ataque' ? item.atributo_ataque : item.atributo_defesa %></span>
                                    </li>
                                    <% } %>
                                <% }); %>
                            <% } %>
                        </ul>
                    </div>
                    
                </div>

                <p class="text-melhorar" >selecione um pra melhorar:</p>
                <form id="melhorarForm" action="/ferreiro/melhorar" method="POST">
                    <select class="selectes" name="item_id" id="itens-disponiveis">
                        <option class="optiones" value="" disabled selected>Selecione um item</option>
                        <% inventario.forEach(item => { %>
                            <% if (item.atributo_chave !== 'nenhum') { %>
                                <option value="<%= item.id %>"> 
                                    <%= item.id %> <%= item.nome %> - <%= item.atributo_chave %>: <%= item.atributo_chave === 'Ataque' ? item.atributo_ataque : item.atributo_defesa %>
                                </option>
                            <% } %>
                        <% }); %>
                    </select>
                    <button class="btn-melhorar" >Melhorar</button>
                </form>
            </div>
            <div class="col-4 col-s-2"></div>
        </div>
    </main>
    <%- include('partials/footer') %>
</body>
<script>
    document.addEventListener('DOMContentLoaded', () => {
    const infoPet = document.querySelectorAll('.pet-info');
    const btnAdotar = document.querySelectorAll('.btn-adotar-toggle');
    const btnEditar = document.querySelectorAll('.btn-editar-toggle');
    const btnConcluir = document.querySelectorAll('.btn-concluir-toggle');
    const inputReno = document.querySelectorAll('.input_reno');
    const inputPetReno = document.querySelectorAll('.input_pet_reno');
    const nomeReno = document.querySelectorAll('.nome_reno');
    const nomePetReno = document.querySelectorAll('.nome_pet_reno');

    btnEditar.forEach(button => {
        button.addEventListener('click', () => {
            inputReno.forEach(input => {
                input.classList.toggle('opcoes-save');
            });
            nomeReno.forEach(nome => {
                nome.classList.toggle('opcoes-save');
            });
            inputPetReno.forEach(input => {
                input.classList.toggle('opcoes-save');
            });
            nomePetReno.forEach(nome => {
                nome.classList.toggle('opcoes-save');
            });
            btnConcluir.forEach(btn => {
                btn.classList.toggle('opcoes-save');
            });
            button.classList.toggle('opcoes-save');
        });
    });

    btnConcluir.forEach(button => {
        button.addEventListener('click', () => {
            inputReno.forEach(input => {
                input.classList.toggle('opcoes-save');
            });
            nomeReno.forEach(nome => {
                nome.classList.toggle('opcoes-save');
            });
            inputPetReno.forEach(input => {
                input.classList.toggle('opcoes-save');
            });
            nomePetReno.forEach(nome => {
                nome.classList.toggle('opcoes-save');
            });
            btnEditar.forEach(btn => {
                btn.classList.toggle('opcoes-save');
            });
            button.classList.toggle('opcoes-save');
        });
    });

    btnAdotar.forEach(button => {
        button.addEventListener('click', () => {
            infoPet.forEach(pet => {
                pet.classList.toggle('opcoes-save');
            });
            button.classList.toggle('opcoes-save');
        });
    });
    });
</script>
</html>